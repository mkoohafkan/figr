%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{figr-test}

figr test
---------

Inspired by [this blog post](http://rmflight.github.io/posts/2012/10/papersinRmd.html), `figr` is designed to be a simple figure and table reference manager. This vignette shows how to use the package. 

First, create a figure:
```{r message=FALSE, warning=FALSE}
require(ggplot2)
p = qplot(rnorm(500),geom="histogram")
```

Now we use figr to index it:
```{r message=FALSE}
require(figr)
addFigure('example', p, caption='a histogram.')
# note that figr makes a copy of the plot object
rm(p)
```

now we place it:
```{r message=FALSE, warning=FALSE}
placeFigure('example')
```

Figr determines figure numbers by 'ranking' them based on where they are placed or cited in the document. We can reference `r citeFigure("example")` (I just did!) by typing `citeFigure("example")`. If we want to write out the full caption, we can type `citeFigure("example", caption=TRUE)` to get `r citeFigure("example", caption=TRUE)` Note that if we place the figure again, its ranking is not updated. This is a side effect of code that allows a figure to be cited before it is placed.

```{r message=FALSE, warning=FALSE}
placeFigure('example')
citeFigure("example")
```

A figure is not ranked until it is placed or cited, so if for some reason you need to refer to a later figure, you need to cite any intervening figures first. 

```{r message=FALSE, warning=FALSE}
# note you don't actually have to create a figure to cite it! Bug or Feature?
invisible(citeFigure('ex2'))
```

We'll get to `r citeFigure('ex3')` in a second, but first look at `r citeFigure('ex2')`:

```{r message=FALSE, warning=FALSE}
p2 = qplot(rlnorm(500),geom="histogram")
addFigure('ex2', p2, 'Another plot.')
placeFigure('ex2')
```

Okay, now for `r citeFigure('ex3')`:

```{r message=FALSE, warning=FALSE}
p3 = qplot(rgamma(500, 3), geom='histogram')
addFigure('ex3', p3, 'A third plot.')
placeFigure('ex3')
```

This is a somewhat strange use case, but it may be necessary to create a list of figures or tables at the start of the document (although then) If you are creating a long or complicated documents it may be better to use LaTeX instead of Markdown anyway.

The extension of the package to kable tables is obvious.

```{r message=FALSE, warning=FALSE, results='asis'}
require(knitr)
# note only the data is passed to addTable
d = head(iris[,1:3])
# note that tables and figures can have the identical keys
addTable('example', d, caption='a table.')
citeTable("example", caption=TRUE)
kable(placeTable('example'))
```
